"use strict";(()=>{var e={};e.id=777,e.ids=[777],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2392:(e,t,i)=>{i.r(t),i.d(t,{originalPathname:()=>v,patchFetch:()=>x,requestAsyncStorage:()=>h,routeModule:()=>g,serverHooks:()=>f,staticGenerationAsyncStorage:()=>y});var n={};i.r(n),i.d(n,{GET:()=>m,POST:()=>u});var r=i(9303),o=i(8716),s=i(670);let a={thresholds:{dtiHigh:.4,credit:{excellentMin:750,goodMin:650}},scoring:{dtiHigh:2,credit:{excellent:0,good:1,poor:2},rental:{evictionPoints:3,latePaymentsThreshold:3,latePaymentsPoints:2},criminal:{hasRecordPoints:3},employment:{fullTime:0,partTime:1,unemployed:2}},decision:{approvedMax:3,flaggedMax:6}},l=[],c=require("crypto");function d(e){let t="string"==typeof e?Number(e):e;return Number.isFinite(t)?t:void 0}async function u(e){try{var t;let i=await e.json(),n=function(e){let t=[],i=d(e?.income),n=d(e?.debt),r=d(e?.credit_score);(void 0===i||i<0)&&t.push("income must be a non-negative number"),(void 0===n||n<0)&&t.push("debt must be a non-negative number"),(void 0===r||r<300||r>850)&&t.push("credit_score must be a number between 300 and 850");let o=e?.rental_history??{},s=d(o?.evictions),a=d(o?.late_payments);(void 0===s||s<0)&&t.push("rental_history.evictions must be a non-negative number"),(void 0===a||a<0)&&t.push("rental_history.late_payments must be a non-negative number");let l=e?.criminal_background??{},c=!!l?.has_criminal_record,u=l?.type_of_crime,m=e?.employment_status,p=["full-time","part-time","unemployed"];return(p.includes(m)||t.push(`employment_status must be one of: ${p.join(", ")}`),t.length)?{ok:!1,errors:t}:{ok:!0,data:{income:i,debt:n,credit_score:r,rental_history:{evictions:s,late_payments:a},criminal_background:{has_criminal_record:c,type_of_crime:"string"==typeof u?u:null},employment_status:m}}}(i);if(!n.ok)return Response.json({errors:n.errors},{status:400});let r=function(e){let t=[];if(!e||"object"!=typeof e)return{value:a,errors:t};let i=JSON.parse(JSON.stringify(a));if(e.thresholds&&(p(e.thresholds.dtiHigh)&&(i.thresholds.dtiHigh=e.thresholds.dtiHigh),e.thresholds.credit)){let t=e.thresholds.credit;p(t.excellentMin)&&(i.thresholds.credit.excellentMin=t.excellentMin),p(t.goodMin)&&(i.thresholds.credit.goodMin=t.goodMin)}if(e.scoring){if(p(e.scoring.dtiHigh)&&(i.scoring.dtiHigh=e.scoring.dtiHigh),e.scoring.credit){let t=e.scoring.credit;p(t.excellent)&&(i.scoring.credit.excellent=t.excellent),p(t.good)&&(i.scoring.credit.good=t.good),p(t.poor)&&(i.scoring.credit.poor=t.poor)}if(e.scoring.rental){let t=e.scoring.rental;p(t.evictionPoints)&&(i.scoring.rental.evictionPoints=t.evictionPoints),p(t.latePaymentsThreshold)&&(i.scoring.rental.latePaymentsThreshold=t.latePaymentsThreshold),p(t.latePaymentsPoints)&&(i.scoring.rental.latePaymentsPoints=t.latePaymentsPoints)}if(e.scoring.criminal){let t=e.scoring.criminal;p(t.hasRecordPoints)&&(i.scoring.criminal.hasRecordPoints=t.hasRecordPoints)}if(e.scoring.employment){let t=e.scoring.employment;p(t.fullTime)&&(i.scoring.employment.fullTime=t.fullTime),p(t.partTime)&&(i.scoring.employment.partTime=t.partTime),p(t.unemployed)&&(i.scoring.employment.unemployed=t.unemployed)}}return e.decision&&(p(e.decision.approvedMax)&&(i.decision.approvedMax=e.decision.approvedMax),p(e.decision.flaggedMax)&&(i.decision.flaggedMax=e.decision.flaggedMax)),i.thresholds.credit.goodMin<=i.thresholds.credit.excellentMin||t.push("thresholds.credit.goodMin must be <= thresholds.credit.excellentMin"),i.decision.approvedMax<=i.decision.flaggedMax||t.push("decision.approvedMax must be <= decision.flaggedMax"),i.thresholds.dtiHigh>=0||t.push("thresholds.dtiHigh must be >= 0"),{value:i,errors:t}}(i?.config);if(r.errors.length)return Response.json({errors:r.errors},{status:400});let{risk_score:o,decision:s}=function(e,t=a){let i=function(e,t=a){var i,n,r,o,s;let l,c=0;return i=e.income,n=e.debt,(i<=0?1/0:n/i)>t.thresholds.dtiHigh&&(c+=t.scoring.dtiHigh),c+=function(e,t){if(t){let{excellentMin:i,goodMin:n}=t.thresholds.credit;return e>=i?t.scoring.credit.excellent:e>=n?t.scoring.credit.good:t.scoring.credit.poor}return e>=750?0:e>=650?1:2}(e.credit_score,t)+(r=e.rental_history,l=0,t?(r.evictions>0&&(l+=t.scoring.rental.evictionPoints),r.late_payments>t.scoring.rental.latePaymentsThreshold&&(l+=t.scoring.rental.latePaymentsPoints)):(r.evictions>0&&(l+=3),r.late_payments>3&&(l+=2)),l)+(o=e.criminal_background,t?o.has_criminal_record?t.scoring.criminal.hasRecordPoints:0:o.has_criminal_record?3:0)+(s=e.employment_status,t?"full-time"===s?t.scoring.employment.fullTime:"part-time"===s?t.scoring.employment.partTime:t.scoring.employment.unemployed:"full-time"===s?0:"part-time"===s?1:2)}(e,t),n=function(e,t=a){return e<=t.decision.approvedMax?"Approved":e<=t.decision.flaggedMax?"Flagged for Review":"Denied"}(i,t);return{risk_score:i,decision:n}}(n.data,r.value);return t={id:(0,c.randomUUID)(),timestamp:new Date().toISOString(),input:n.data,risk_score:o,decision:s},l.unshift(t),l.length>50&&(l.length=50),Response.json({risk_score:o,decision:s})}catch(e){return Response.json({error:"Invalid JSON payload"},{status:400})}}async function m(){return Response.json({audits:l})}function p(e){return"number"==typeof e&&Number.isFinite(e)}let g=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/screening/route",pathname:"/api/screening",filename:"route",bundlePath:"app/api/screening/route"},resolvedPagePath:"C:\\Users\\plabr\\tenant_Screen\\src\\app\\api\\screening\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:h,staticGenerationAsyncStorage:y,serverHooks:f}=g,v="/api/screening/route";function x(){return(0,s.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:y})}},9303:(e,t,i)=>{e.exports=i(517)}};var t=require("../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),n=t.X(0,[948],()=>i(2392));module.exports=n})();