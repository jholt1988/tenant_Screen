(()=>{var a={};a.id=434,a.ids=[434],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},4870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6111:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>E,patchFetch:()=>D,routeModule:()=>z,serverHooks:()=>C,workAsyncStorage:()=>A,workUnitAsyncStorage:()=>B});var d={};c.r(d),c.d(d,{GET:()=>x,POST:()=>w});var e=c(8647),f=c(5008),g=c(255),h=c(7495),i=c(3265),j=c(261),k=c(8707),l=c(8173),m=c(2399),n=c(4748),o=c(9610),p=c(976),q=c(7138),r=c(247),s=c(6439),t=c(3933);let u=require("crypto");function v(a){let b="string"==typeof a?Number(a):a;return Number.isFinite(b)?b:void 0}async function w(a){try{let b=await a.json(),c=function(a){let b,c=[],d=v(a?.income),e=v(a?.monthly_rent),f=v(a?.debt),g=v(a?.credit_score);(void 0===d||d<0)&&c.push("income must be a non-negative number"),(void 0===e||e<0)&&c.push("monthly_rent must be a non-negative number"),(void 0===f||f<0)&&c.push("debt must be a non-negative number"),(void 0===g||g<300||g>850)&&c.push("credit_score must be a number between 300 and 850");let h=a?.rental_history??{},i=v(h?.evictions),j=v(h?.late_payments);(void 0===i||i<0)&&c.push("rental_history.evictions must be a non-negative number"),(void 0===j||j<0)&&c.push("rental_history.late_payments must be a non-negative number");let k=h?.eviction_filings,l=["filed","dismissed","settled","judgment"];if(void 0!==k)if(Array.isArray(k)){for(let[a,d]of(b=[],k.entries())){let e=d?.outcome,f="string"==typeof e?e.toLowerCase():void 0,g=d?.filed_at;if(!f||!l.includes(f)){c.push(`rental_history.eviction_filings[${a}].outcome must be one of ${l.join(", ")}`);continue}if("string"!=typeof g||Number.isNaN(new Date(g).getTime())){c.push(`rental_history.eviction_filings[${a}].filed_at must be an ISO date string`);continue}b.push({outcome:f,filed_at:g})}0===b.length&&(b=void 0)}else c.push("rental_history.eviction_filings must be an array when provided");let m=a?.criminal_background??{},n=!!m?.has_criminal_record,o=m?.type_of_crime,p=Array.isArray(m?.records)?m.records:[],q=[];p.forEach((a,b)=>{let d=a?.severity,e=a?.category,f=v(a?.years_since),g="felony"===d||"misdemeanor"===d,h=["violent","property","drug","other"].includes(e);g||c.push(`criminal_background.records[${b}].severity must be 'felony' or 'misdemeanor'`),h||c.push(`criminal_background.records[${b}].category must be one of violent, property, drug, other`),(void 0===f||f<0)&&c.push(`criminal_background.records[${b}].years_since must be a non-negative number`),g&&h&&void 0!==f&&f>=0&&q.push({severity:d,category:e,years_since:f,description:"string"==typeof a?.description?a.description:null})});let r=a?.employment_status,s=["full-time","part-time","unemployed"];return(s.includes(r)||c.push(`employment_status must be one of: ${s.join(", ")}`),c.length)?{ok:!1,errors:c}:{ok:!0,data:{income:d,monthly_rent:e,debt:f,credit_score:g,rental_history:{evictions:i,late_payments:j},criminal_background:{has_criminal_record:n,type_of_crime:"string"==typeof o?o:null,records:q.length?q:void 0},employment_status:r}}}(b);if(!c.ok)return Response.json({errors:c.errors},{status:400});let d=function(a){let b=[];if(!a||"object"!=typeof a)return{value:Object(function(){var a=Error("Cannot find module '@/lib/screeningConfig'");throw a.code="MODULE_NOT_FOUND",a}()),errors:b};let c=JSON.parse(JSON.stringify(Object(function(){var a=Error("Cannot find module '@/lib/screeningConfig'");throw a.code="MODULE_NOT_FOUND",a}())));if(a.thresholds){if(y(a.thresholds.dtiHigh)&&(c.thresholds.dtiHigh=a.thresholds.dtiHigh),a.thresholds.affordability){let b=a.thresholds.affordability;y(b.rentRule)&&(c.thresholds.affordability.rentRule=b.rentRule),y(b.partialCreditRatio)&&(c.thresholds.affordability.partialCreditRatio=b.partialCreditRatio),y(b.dtiMitigation)&&(c.thresholds.affordability.dtiMitigation=b.dtiMitigation),y(b.dtiException)&&(c.thresholds.affordability.dtiException=b.dtiException)}if(a.thresholds.credit){let b=a.thresholds.credit;y(b.excellentMin)&&(c.thresholds.credit.excellentMin=b.excellentMin),y(b.goodMin)&&(c.thresholds.credit.goodMin=b.goodMin)}if(a.thresholds.alternativeData&&a.thresholds.alternativeData.utility){c.thresholds.alternativeData||(c.thresholds.alternativeData=JSON.parse(JSON.stringify(Object(function(){var a=Error("Cannot find module '@/lib/screeningConfig'");throw a.code="MODULE_NOT_FOUND",a}()).thresholds.alternativeData??{utility:{strong:.9,moderate:.8,weak:.65}})));let b=a.thresholds.alternativeData.utility;y(b.strong)&&(c.thresholds.alternativeData.utility.strong=b.strong),y(b.moderate)&&(c.thresholds.alternativeData.utility.moderate=b.moderate),y(b.weak)&&(c.thresholds.alternativeData.utility.weak=b.weak)}a.thresholds.rental&&y(a.thresholds.rental.evictionLookbackYears)&&(c.thresholds.rental||(c.thresholds.rental={evictionLookbackYears:5}),c.thresholds.rental.evictionLookbackYears=a.thresholds.rental.evictionLookbackYears)}if(a.scoring){if(y(a.scoring.dtiHigh)&&(c.scoring.dtiHigh=a.scoring.dtiHigh),a.scoring.affordability){let b=a.scoring.affordability;y(b.meetsRule)&&(c.scoring.affordability.meetsRule=b.meetsRule),y(b.partialCredit)&&(c.scoring.affordability.partialCredit=b.partialCredit),y(b.dtiException)&&(c.scoring.affordability.dtiException=b.dtiException),y(b.fail)&&(c.scoring.affordability.fail=b.fail)}if(a.scoring.credit){let b=a.scoring.credit;y(b.excellent)&&(c.scoring.credit.excellent=b.excellent),y(b.good)&&(c.scoring.credit.good=b.good),y(b.poor)&&(c.scoring.credit.poor=b.poor)}if(a.scoring.rental){let b=a.scoring.rental;if(y(b.evictionPoints)&&(c.scoring.rental.evictionPoints=b.evictionPoints),y(b.latePaymentsThreshold)&&(c.scoring.rental.latePaymentsThreshold=b.latePaymentsThreshold),y(b.latePaymentsPoints)&&(c.scoring.rental.latePaymentsPoints=b.latePaymentsPoints),y(b.excellentReferenceOffset)&&(c.scoring.rental.excellentReferenceOffset=b.excellentReferenceOffset),y(b.satisfactoryReferenceOffset)&&(c.scoring.rental.satisfactoryReferenceOffset=b.satisfactoryReferenceOffset),y(b.concernReferencePoints)&&(c.scoring.rental.concernReferencePoints=b.concernReferencePoints),b.evictionOutcomePoints){let a={...c.scoring.rental.evictionOutcomePoints??Object(function(){var a=Error("Cannot find module '@/lib/screeningConfig'");throw a.code="MODULE_NOT_FOUND",a}()).scoring.rental.evictionOutcomePoints??{filing:c.scoring.rental.evictionPoints,dismissed:c.scoring.rental.evictionPoints,settled:c.scoring.rental.evictionPoints,judgment:c.scoring.rental.evictionPoints}},d=b.evictionOutcomePoints;y(d.filing)&&(a.filing=d.filing),y(d.dismissed)&&(a.dismissed=d.dismissed),y(d.settled)&&(a.settled=d.settled),y(d.judgment)&&(a.judgment=d.judgment),c.scoring.rental.evictionOutcomePoints=a}y(b.evictionTimeDecayFloor)&&(c.scoring.rental.evictionTimeDecayFloor=b.evictionTimeDecayFloor)}if(a.scoring.criminal){let b=a.scoring.criminal;y(b.cleanRecordPoints)&&(c.scoring.criminal.cleanRecordPoints=b.cleanRecordPoints),y(b.staleRecordPoints)&&(c.scoring.criminal.staleRecordPoints=b.staleRecordPoints),y(b.recentMisdemeanorPoints)&&(c.scoring.criminal.recentMisdemeanorPoints=b.recentMisdemeanorPoints),y(b.recentFelonyPoints)&&(c.scoring.criminal.recentFelonyPoints=b.recentFelonyPoints),y(b.recentViolentFelonyPoints)&&(c.scoring.criminal.recentViolentFelonyPoints=b.recentViolentFelonyPoints)}if(a.scoring.employment){let b=a.scoring.employment;y(b.fullTime)&&(c.scoring.employment.fullTime=b.fullTime),y(b.partTime)&&(c.scoring.employment.partTime=b.partTime),y(b.unemployed)&&(c.scoring.employment.unemployed=b.unemployed)}if(a.scoring.alternativeData){c.scoring.alternativeData||(c.scoring.alternativeData=JSON.parse(JSON.stringify(Object(function(){var a=Error("Cannot find module '@/lib/screeningConfig'");throw a.code="MODULE_NOT_FOUND",a}()).scoring.alternativeData??{utilityStrongOffset:0,utilityModerateOffset:0,utilityWeakPoints:0})));let b=a.scoring.alternativeData;y(b.utilityStrongOffset)&&(c.scoring.alternativeData.utilityStrongOffset=b.utilityStrongOffset),y(b.utilityModerateOffset)&&(c.scoring.alternativeData.utilityModerateOffset=b.utilityModerateOffset),y(b.utilityWeakPoints)&&(c.scoring.alternativeData.utilityWeakPoints=b.utilityWeakPoints)}}return a.decision&&(y(a.decision.approvedMax)&&(c.decision.approvedMax=a.decision.approvedMax),y(a.decision.flaggedMax)&&(c.decision.flaggedMax=a.decision.flaggedMax)),c.thresholds.credit.goodMin<=c.thresholds.credit.excellentMin||b.push("thresholds.credit.goodMin must be <= thresholds.credit.excellentMin"),c.decision.approvedMax<=c.decision.flaggedMax||b.push("decision.approvedMax must be <= decision.flaggedMax"),c.thresholds.dtiHigh>=0||b.push("thresholds.dtiHigh must be >= 0"),c.thresholds.affordability.partialCreditRatio<=c.thresholds.affordability.rentRule||b.push("thresholds.affordability.partialCreditRatio must be <= thresholds.affordability.rentRule"),c.thresholds.affordability.dtiException<=c.thresholds.affordability.dtiMitigation||b.push("thresholds.affordability.dtiException must be <= thresholds.affordability.dtiMitigation"),{value:c,errors:b}}(b?.config);if(d.errors.length)return Response.json({errors:d.errors},{status:400});let e="string"==typeof b?.jurisdiction?b.jurisdiction:void 0,f=e?Object(function(){var a=Error("Cannot find module '@/lib/jurisdictions'");throw a.code="MODULE_NOT_FOUND",a}())(e):void 0;if(e&&!f)return Response.json({errors:[`Unknown jurisdiction policy: ${e}`]},{status:400});let g=Object(function(){var a=Error("Cannot find module '@/lib/screening'");throw a.code="MODULE_NOT_FOUND",a}())(c.data,d.value,{policy:f}),{risk_score:h,decision:i}=g,j=Object(function(){var a=Error("Cannot find module '@/lib/adverseActionNotice'");throw a.code="MODULE_NOT_FOUND",a}())(i,c.data);return Object(function(){var a=Error("Cannot find module '@/lib/audit'");throw a.code="MODULE_NOT_FOUND",a}())({id:(0,u.randomUUID)(),timestamp:new Date().toISOString(),input:c.data,risk_score:h,decision:i,compliance:g.compliance}),Response.json({risk_score:h,decision:i,compliance:g.compliance,notice:j})}catch(a){return Response.json({error:"Invalid JSON payload"},{status:400})}}async function x(){return Response.json({audits:Object(function(){var a=Error("Cannot find module '@/lib/audit'");throw a.code="MODULE_NOT_FOUND",a}())()})}function y(a){return"number"==typeof a&&Number.isFinite(a)}!function(){var a=Error("Cannot find module '@/lib/screening'");throw a.code="MODULE_NOT_FOUND",a}(),function(){var a=Error("Cannot find module '@/lib/audit'");throw a.code="MODULE_NOT_FOUND",a}(),function(){var a=Error("Cannot find module '@/lib/screeningConfig'");throw a.code="MODULE_NOT_FOUND",a}(),function(){var a=Error("Cannot find module '@/lib/jurisdictions'");throw a.code="MODULE_NOT_FOUND",a}(),function(){var a=Error("Cannot find module '@/lib/adverseActionNotice'");throw a.code="MODULE_NOT_FOUND",a}();let z=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/screening/route",pathname:"/api/screening",filename:"route",bundlePath:"app/api/screening/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/home/runner/work/tenant_Screen/tenant_Screen/src/app/api/screening/route.ts",nextConfigOutput:"",userland:d}),{workAsyncStorage:A,workUnitAsyncStorage:B,serverHooks:C}=z;function D(){return(0,g.patchFetch)({workAsyncStorage:A,workUnitAsyncStorage:B})}async function E(a,b,c){var d;let e="/api/screening/route";"/index"===e&&(e="/");let g=await z.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:x,prerenderManifest:y,routerServerContext:A,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,resolvedPathname:D}=g,E=(0,j.normalizeAppPath)(e),F=!!(y.dynamicRoutes[E]||y.routes[D]);if(F&&!x){let a=!!y.routes[D],b=y.dynamicRoutes[E];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let G=null;!F||z.isDev||x||(G="/index"===(G=D)?"/":G);let H=!0===z.isDev||!F,I=F&&!H,J=a.method||"GET",K=(0,i.getTracer)(),L=K.getActiveScopeSpan(),M={params:v,prerenderManifest:y,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>z.onRequestError(a,b,d,A)},sharedContext:{buildId:u}},N=new k.NodeNextRequest(a),O=new k.NodeNextResponse(b),P=l.NextRequestAdapter.fromNodeNextRequest(N,(0,l.signalFromNodeResponse)(b));try{let d=async c=>z.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&B&&C&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=M.renderOpts.fetchMetrics;let i=M.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=M.renderOpts.collectedTags;if(!F)return await (0,o.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await z.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})},A),b}},l=await z.handleResponse({req:a,nextConfig:w,cacheKey:G,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:y,isRoutePPREnabled:!1,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,responseGenerator:k,waitUntil:c.waitUntil});if(!F)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",B?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&F||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(N,O,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};L?await g(L):await K.withPropagatedContext(a.headers,()=>K.trace(m.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},g))}catch(b){if(b instanceof s.NoFallbackError||await z.onRequestError(a,b,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})}),F)throw b;return await (0,o.I)(N,O,new Response(null,{status:500})),null}}},6439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},6610:()=>{},8647:(a,b,c)=>{"use strict";a.exports=c(4870)},8682:()=>{},9294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9610:(a,b,c)=>{"use strict";Object.defineProperty(b,"I",{enumerable:!0,get:function(){return g}});let d=c(8202),e=c(7983),f=c(976);async function g(a,b,c,g){if((0,d.isNodeNextResponse)(b)){var h;b.statusCode=c.status,b.statusMessage=c.statusText;let d=["set-cookie","www-authenticate","proxy-authenticate","vary"];null==(h=c.headers)||h.forEach((a,c)=>{if("x-middleware-set-cookie"!==c.toLowerCase())if("set-cookie"===c.toLowerCase())for(let d of(0,f.splitCookiesString)(a))b.appendHeader(c,d);else{let e=void 0!==b.getHeader(c);(d.includes(c.toLowerCase())||!e)&&b.appendHeader(c,a)}});let{originalResponse:i}=b;c.body&&"HEAD"!==a.method?await (0,e.pipeToNodeResponse)(c.body,i,g):i.end()}}}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[371],()=>b(b.s=6111));module.exports=c})();